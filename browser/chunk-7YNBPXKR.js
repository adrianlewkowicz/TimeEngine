import{b,e as P,h as w,n as M}from"./chunk-NU4DMHDL.js";import{b as _}from"./chunk-7CPXLUAO.js";import{Aa as s,Ab as c,Bb as d,Cb as f,Fa as y,La as v,N as g,S as h,Xa as C,eb as r,fb as a,gb as U,lb as u,wb as l,xa as S}from"./chunk-4WW2NWFA.js";var p=class o{constructor(e){this.http=e}apiUrl="http://localhost:5050/api/auth";getUserProfile(){return this.http.get(`${this.apiUrl}/me`)}updateUserProfile(e){return this.http.put(`${this.apiUrl}/update-profile`,e)}uploadProfilePicture(e){let t=new FormData;return t.append("file",e),this.http.post(`${this.apiUrl}/upload-profile-picture`,t)}static \u0275fac=function(t){return new(t||o)(h(_))};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};var N=class o{constructor(e){this.userService=e}user={};ngOnInit(){this.loadUser()}loadUser(){this.userService.getUserProfile().subscribe(e=>this.user=e)}onFileSelected(e){let t=e.target.files[0];this.userService.uploadProfilePicture(t).subscribe(i=>this.user.profilePictureUrl=i)}saveChanges(){this.userService.updateUserProfile(this.user).subscribe(()=>alert("Zmiany zapisane!"))}static \u0275fac=function(t){return new(t||o)(y(p))};static \u0275cmp=v({type:o,selectors:[["app-settings"]],decls:15,vars:3,consts:[[1,"settings-container"],[1,"profile-section"],[1,"profile-img",3,"src"],["type","file",3,"change"],[1,"form-group"],[3,"ngModelChange","ngModel"],["pButton","","label","Zapisz zmiany",3,"click"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"h2"),l(2,"\u2699\uFE0F Ustawienia Konta"),a(),r(3,"div",1),U(4,"img",2),r(5,"input",3),u("change",function(n){return i.onFileSelected(n)}),a()(),r(6,"div",4)(7,"label"),l(8,"Imi\u0119 i nazwisko:"),a(),r(9,"input",5),f("ngModelChange",function(n){return d(i.user.fullName,n)||(i.user.fullName=n),n}),a()(),r(10,"div",4)(11,"label"),l(12,"Nazwa Firmy:"),a(),r(13,"input",5),f("ngModelChange",function(n){return d(i.user.companyName,n)||(i.user.companyName=n),n}),a()(),r(14,"button",6),u("click",function(){return i.saveChanges()}),a()()),t&2&&(s(4),C("src",i.user.profilePictureUrl||"assets/default-avatar.png",S),s(5),c("ngModel",i.user.fullName),s(4),c("ngModel",i.user.companyName))},dependencies:[M,b,P,w],encapsulation:2})};export{N as SettingsComponent};
